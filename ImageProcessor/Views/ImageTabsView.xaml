<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:microcharts="clr-namespace:Microcharts.Maui;assembly=Microcharts.Maui"
    x:Class="ImageProcessor.Views.ImageTabsView"
    Title="Process Images">
    
    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="20,80,20,20" Spacing="15">

                <Label Text="Processing" 
                       FontSize="20" 
                       HorizontalOptions="Center" />

                <!-- Image Selection Section -->
                <!-- Image A -->
                <Button x:Name="ButtonImageA" 
                        Text="Select Image A" 
                        Clicked="OnSelectImageAClicked" />

                <VerticalStackLayout Spacing="10" 
                                   Padding="10" 
                                   BackgroundColor="LightBlue">
                    <ActivityIndicator x:Name="LoadingIndicatorA" 
                                     IsVisible="False" 
                                     IsRunning="False"
                                     Color="DodgerBlue"
                                     HeightRequest="50" />
                    <Image x:Name="SelectedImageA" 
                           HeightRequest="200" 
                           Aspect="AspectFit"
                           IsVisible="False" />
                </VerticalStackLayout>

                <!-- Image B -->
                <Button x:Name="ButtonImageB" 
                        Text="Select Image B" 
                        Clicked="OnSelectImageBClicked" />

                <VerticalStackLayout Spacing="10" 
                                   Padding="10" 
                                   BackgroundColor="LightBlue">
                    <ActivityIndicator x:Name="LoadingIndicatorB" 
                                     IsVisible="False" 
                                     IsRunning="False"
                                     Color="DodgerBlue"
                                     HeightRequest="50" />
                    <Image x:Name="SelectedImageB" 
                           HeightRequest="200" 
                           Aspect="AspectFit"
                           IsVisible="False" />
                </VerticalStackLayout>

                <!-- Result Section -->
                <Label x:Name="ResultLabel" 
                       Text="Resultado" 
                       FontSize="18" 
                       HorizontalOptions="Center" 
                       IsVisible="False"/>

                <VerticalStackLayout Spacing="10" 
                                   Padding="10" 
                                   BackgroundColor="Lavender">
                    <ActivityIndicator x:Name="LoadingIndicatorOperation" 
                                     IsVisible="False" 
                                     IsRunning="False"
                                     Color="Purple"
                                     HeightRequest="50" />
                    <Image x:Name="ResultImage" 
                           HeightRequest="220" 
                           Aspect="AspectFit" 
                           IsVisible="False" />
                    <Button x:Name="SaveResultButton" 
                            Text="ðŸ’¾ Salvar" 
                            Clicked="OnSaveResultClicked" 
                            IsVisible="False" 
                            BackgroundColor="Green" 
                            TextColor="White" />
                </VerticalStackLayout>

                <VerticalStackLayout Padding="10" Spacing="10" BackgroundColor="DarkSlateGrey" IsVisible="False" x:Name="HistogramContainer">
                    <Label Text="Histogramas - Antes e Depois da EqualizaÃ§Ã£o" 
                           FontSize="18" 
                           HorizontalOptions="Center"
                           FontAttributes="Bold"/>

                                    <Label Text="Antes da EqualizaÃ§Ã£o" 
                           FontSize="14" 
                           HorizontalOptions="Center"/>
                                    <microcharts:ChartView x:Name="HistogramChartBefore" HeightRequest="180"/>

                                <Label Text="Depois da EqualizaÃ§Ã£o" 
                           FontSize="14" 
                           HorizontalOptions="Center"
                           Margin="0,10,0,0"/>
                    <microcharts:ChartView x:Name="HistogramChartAfter" HeightRequest="180"/>
                </VerticalStackLayout>

                <!-- Operations Section -->
                <Label Text="Arithmetic Operations" 
                       FontSize="18" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center"
                       Margin="0,10,0,15"/>

                <VerticalStackLayout Spacing="8" Padding="12">

                        <!-- Basic Operations -->
                        <Label Text="Image Operations" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               Margin="0,0,0,8"/>

                        <Button x:Name="SumButton" 
                                Text="Sum (A + B)" 
                                Clicked="OnSumClicked" />

                        <Button x:Name="SubtButton" 
                                Text="Subtraction (A - B)" 
                                Clicked="SubtButton_Clicked" />
                        <Button x:Name="AbsoluteDifferenceButton" 
                                Text="Absolute Difference (A - B)" 
                                Clicked="AbsoluteDifferenceButton_Clicked" />

                        <Button x:Name="AverageButton" 
                                Text="Average (A + B)" 
                                Clicked="AverageButton_Clicked"/>

                        <!-- Value Operations -->
                        <Label Text="Value Operations" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               Margin="0,16,0,8"/>

                        <HorizontalStackLayout Spacing="8">
                            <Button x:Name="SumValueButton" 
                                    Text="Sum (A + Value)" 
                                    Clicked="SumValueButton_Clicked" 
                                    WidthRequest="160"/>
                            <Label Text="Value:" 
                                   VerticalOptions="Center"/>
                            <Entry x:Name="SumValue" 
                                   Placeholder="0.1" 
                                   Keyboard="Numeric"
                                   WidthRequest="80"/>
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Button x:Name="SubtValueButton" 
                                    Text="Subtract (A - Value)" 
                                    Clicked="SubtValueButton_Clicked" 
                                    WidthRequest="160"/>
                            <Label Text="Value:" 
                                   VerticalOptions="Center"/>
                            <Entry x:Name="SubtValue" 
                                   Placeholder="0.1" 
                                   Keyboard="Numeric"
                                   WidthRequest="80"/>
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Button x:Name="MultButton" 
                                    Text="Multiply (A Ã— Value)" 
                                    Clicked="MultButton_Clicked" 
                                    WidthRequest="160"/>
                            <Label Text="Value:" 
                                   VerticalOptions="Center"/>
                            <Entry x:Name="MultiplicationValue" 
                                   Placeholder="0.1" 
                                   Keyboard="Numeric"
                                   WidthRequest="80"/>
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Button x:Name="DivisionButton" 
                                    Text="Divide (A Ã· Value)" 
                                    Clicked="DivisionButton_Clicked" 
                                    WidthRequest="160"/>
                            <Label Text="Value:" 
                                   VerticalOptions="Center"/>
                            <Entry x:Name="DivisionValue" 
                                   Placeholder="0.1" 
                                   Keyboard="Numeric"
                                   WidthRequest="80"/>
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Button x:Name="BlendingButton" Text="Linear Blending (A âŠ• B)" Clicked="BlendingButton_Clicked" WidthRequest="160"/>
                            <Label Text="Ratio:" VerticalOptions="Center"/>
                            <Entry x:Name="BlendingRatio" Placeholder="0.5" Keyboard="Numeric" WidthRequest="80"/>
                        </HorizontalStackLayout>

                        <!-- Image Transformations -->
                        <Label Text="Image Transformations" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               Margin="0,16,0,8"/>

                        <Button x:Name="ConvertToGrayScale" 
                                Text="Convert to Grayscale" 
                                Clicked="ConvertToGrayScale_Clicked" />

                        <Grid ColumnDefinitions="*,*" 
                              ColumnSpacing="8">
                            <Button x:Name="FlipLeftToRight" 
                                    Text="Flip Horizontal" 
                                    Clicked="FlipLeftToRight_Clicked"
                                    Grid.Column="0"/>
                            <Button x:Name="FlipTopToBottom" 
                                    Text="Flip Vertical" 
                                    Clicked="FlipTopToBottom_Clicked"
                                    Grid.Column="1"/>
                        </Grid>
                        <Button x:Name="NegativeButton" Text="Image Negative" Clicked="NegativeButton_Clicked" />
                        <Button x:Name="ThresholdButton" Text="Thresholding" Clicked="ThresholdButton_Clicked"/>
                        <Button x:Name="HistogramEqualizationButton" Text="Histogram Equalization" Clicked="HistogramEqualizationButton_Clicked" />

                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Reload Button - Fixed Position -->
        <Button Text="â†»" 
                BackgroundColor="DodgerBlue"
                TextColor="White"
                FontSize="20"
                FontAttributes="Bold"
                CornerRadius="25"
                WidthRequest="50"
                HeightRequest="50"
                HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="15,30,15,0"
                Clicked="OnReloadClicked" />
    </Grid>
</ContentPage>